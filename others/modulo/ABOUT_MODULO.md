# 「1000000007 で割った余り」を求める問題

- 足し算と掛け算は計算途中であまりをとってよい
- 引き算も途中であまりをとっていいが、最終結果が負になる場合、最終結果に 1000000007 を足す(Python では勝手にやってくれるので必要ない)
- 割り算は割る数の逆元をかける

## mod p の世界での割り算

割り算の場合は、予めあまりを撮って計算すると、結果が変わってしまうため工夫が必要

ここで mod 13 の世界を考える。
9 ÷ 4 ≡ x (mod 13) を解く。

※ 合同式の復習
a と b を n で割った余りが等しい時、a ≡ b (mod n) と表す。これを合同式という。
n のことを「法(modulus)」という。

計算過程：
9 ÷ 4 ≡ x (mod 13)
⇔ 9 × (1 ÷ 4) ≡ x
⇔ 4x ≡ 9
ここで、4 × 4 = 16 = 13 × 1 + 3 より
4 × 4 ≡ 3 (mod 13)
⇔ 4 × 12 ≡ 9
よって x ≡ 12 (mod 13)

毎回求めるのは面倒。ここで、フェルマーの小定理より、
p を素数とし、整数 b が p で割り切れない整数とすると、a を整数として
** bx ≡ a (mod p) ** が成り立つ。

x を導出するために a ÷ b (mod p) を計算する必要がある。
ここで、
a ÷ b ≡ a × (1 ÷ b) (mod p)
が成り立つので、1 ÷ b が計算できれば良い。
この 1 ÷ b のことを mod p における b の逆元という。
逆元を求めるアルゴリズムはいくつかある。

## 逆元を求めるアルゴリズム

### 拡張 Euclid 互除法による逆元計算

x が mod p における a の逆元であることを
ax ≡ 1 (mod p)
と表すことができる。両辺に -1 を加えることで
ax - 1 ≡ 0 (mod p)
となり、ax - 1 が p で割り切れることを意味する。

すなわち、
(ax - 1) ÷ p = k
⇔ ax - pk = 1
⇔ ax - py = 1
を満たす 整数 y が存在することを意味する。
これを満たす x は、拡張 Euclid の互除法で求める事ができる。

拡張 Euclid の互除法のアルゴリズムは

互いに素な a, b が与えられたとき
ax + by = 1

を満たす(x, y)を 1 つ求めることである。
